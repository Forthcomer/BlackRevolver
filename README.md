# BlackRevolver

## 作者的话

- 这不是一个制作很精良的游戏，但是或许以后会做得更好。这个游戏创作的初衷纯粹是为了纪念我的高三与那群朋友们玩耍的时光。这个游戏从龙同学带到班上开始，在好几个省理实班都有不错的反响，并且在路上、在宿舍、在课上都有同学在悄咪咪地玩。甚至后来我们班的班长之一还自己设计了学校的地图，加入了同学和老师的角色（都有各自的技能），同学们绞尽脑汁思考技能，在游玩中修改细节。我们就这样无厘头地度过了我们那也不那么枯燥无聊的高三。
- 总而言之，如果你玩过这个游戏，欢迎你再重温一下当年的那种感觉，或者分享给你身边的新朋友们，如果在大学这个各种游戏唾手可得的时间点有人还愿意为你的小爱好驻足的话，无疑是一种幸福。如果你只是不小心点进来了这个游戏，不妨体验一会再走吧。 

## 简介

- BlackRevolver 是一个双层宅邸主题的轻量网页对战小游戏，支持人机（默认）与人人对决模式。
- 双文件实现（`BlackRevolver/index.html` 与 `BlackRevolver.html`），无需构建即可运行，含地图、状态管理、动作交互、日志与音效特效。

## 玩法概览

- 模式选择：
  - 人机（默认）：玩家选择出生房间，电脑随机不同房间就位。
  - 人人对决：玩家 A/B 依次选择出生房间。
- 回合与资源：
  - 每回合开始当前玩家获得 `AP = 2`。
  - 依据房间邻接关系移动、执行技能，部分技能位置受限、AP 消耗不同。
- 可见性：
  - 地雷与控制面板标记仅对布置方可见；作弊模式开启时双方可见。
  - 箭头指示当前玩家位置；作弊/PvP 下可选择显示对手位置。

## 行动与特殊技能

- 移动（1AP）
  - 仅能到相邻且有通道的房间。
- 开枪（消耗全部 AP）
  - 可射击当前房间与相邻房间；在阳台时额外可射击客厅/厨房/餐厅。
  - 若命中，对手 `HP -1`，随后强制移动一步（0AP，受地下室封锁限制）。
- 聆听（1AP）
  - 返回对手可移动到的相邻房间之一；触发铃铛音效（3s）。
- 回声（客厅，0AP）
  - 若敌在二楼，报告准确房间；若在一楼，效果同聆听；触发铃铛音效（3s）。
- 振奋（厨房，0AP）
  - 仅在本回合开始且尚未行动时使用，本回合 `AP +1`。
- 控制面板（地下室，1AP）
  - 选择任意房间；于使用者“下个回合开始”时爆炸，对位于该房间的玩家造成 1 点生命；播放爆炸音（2s）。
- 安装地雷（1AP，任意房间）
  - 在当前位置安装地雷，最多 2 枚；安装时播放语音“The bomb has been placed”。
  - 当回合新安装的地雷不可引爆；下一回合可在任意位置选择任意已布置地雷的房间引爆（1AP），若命中则 `HP -1`，地雷移除，并播放爆炸音（2s）。
- 水淹地下室（卧室，1AP）
  - 若地下室有人则造成 1 伤害并强制其立即移动；直到使用者下一次回合开始前，地下室禁止移动；播放水流音（2s）。
- 跳过栏杆（阳台，0AP）
  - 直接移动到厨房（单向）。
- 地板门开关（图书馆，1AP）
  - 将厨房玩家移至地下室；若地下室处于淹水锁定则该玩家再受 1 伤害并再次强制移动；播放门吱呀音（2s）。
- 胜负与音效
  - 胜利时播放激昂音效（5s），失败时播放哭泣音效（4s）。

## 键盘快捷键

- `M` 移动、`F` 开枪、`L` 聆听、`E` 回声、`I` 振奋、`C` 控制面板、`P` 安装地雷、`D` 引爆地雷、`B` 水淹、`J` 跳栏、`T` 地板门、`Enter` 结束回合。
- 在选项列表显示时，可按数字键 `1..n` 选择第 n 个选项。

## 部署与运行

-- 本地快速预览：
  - 在项目根启动本地服务器：
    - Windows/通用：`python -m http.server 8000`
  - 主页入口：`http://localhost:8000/BlackRevolver/index.html`
  - 直接进入游戏页：
    - 人机模式：`http://localhost:8000/BlackRevolver.html?mode=ai`
    - 人人对决：`http://localhost:8000/BlackRevolver.html?mode=pvp`
-- 静态托管（如 GitHub Pages）：
  - 主页地址示例：`https://<你的用户名>.github.io/BlackRevolver/BlackRevolver/index.html`
  - 或直接游戏页：`https://<你的用户名>.github.io/BlackRevolver/BlackRevolver.html`

## 技术概览

- 界面布局：CSS Grid 构建三列五行房间网格，自适应标记与提示。
- 状态管理：原生 JavaScript 全局 `state` 管理玩家、AP/HP、地雷、控制面板、回合与日志。
- 路径与决策：BFS 计算 AI 接近路径（`bfsNext`）、邻接图驱动行动合法性与射击范围。
- 音效系统：Web Audio API 合成枪声、爆炸、水流、门吱呀、脚步、铃铛；胜负音效为合成旋律；安装地雷使用浏览器 `SpeechSynthesis`（无法使用时回退为提示音）。
- 交互体验：
  - 地图房间右下角标记显示布置方的地雷与控制面板目标；作弊模式显示双方。
  - 右侧操作区含“日志通知栏”，可从底部拉起查看完整日志。
  - 键盘快捷键与按钮禁用状态联动，回合开始/结束自动刷新。
- 持久化：帮助折叠区开关状态存入 `localStorage`。

## 目录结构

- `BlackRevolver/index.html`：主页面
- `BlackRevolver.html`：游戏逻辑
- `README.md`：项目说明文档

## 许可与鸣谢

- 感谢桌游口袋系列给我的灵感，这里制作不精，还请多多指教。
